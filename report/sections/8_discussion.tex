\chapter{Discussion}
\label{ch:discussion}

% The discussion is the most difficult part of the thesis to write.
% It should describe wider meaning, importance, and relevance of the thesis and implications for the wider ecosystem.
% In particular, it should answer the following questions:
% * Interpretations: what do the results mean?
%     * Provide a more high-level interpretation of the evaluation results.
% * Implications: why do the results matter?
%     * How does your thesis relate to the related work?
% * Limitations: what canâ€™t the results tell us?
%     * Are there deployment issues and how are they overcome?


In this chapter, we describe the wider meaning and implications of our findings.
It also discusses the limitations of our work and provides recommendations for Anapaya and SCION deployments in general.
% Finally, we outline potential future work that can build on our analysis.


\section{Interpretations and Implications}
The use of a secure MAC algorithm for calculating the $HFAuth$ field in hop fields is crucial as it ensures path integrity and block any path manipulation attacks.
Fortunately, Anapaya employs the same algorithm as the open-source version, facilitating easy verification and reasoning about the security of the system.

However, the absence of DRKey in Anapaya's implementation exposes the system to various attacks, as discussed in \cref{ch:findings}.
Many of these attacks can be mitigated by implementing a custom source authentication mechanism, though this would require a significant effort and likely would not be as lightweight as SPAO based on DRKey.
Other attacks, such as injecting unauthenticated SCMP error message, can only be mitigated with solutions that are supported by each border router in the entire SCION network, such as DRKey which is already provided in SCION.

Due to the proprietary nature of Anapaya's SCION implementation, they can modify certain parts of the protocol, without having to document or justify these changes.
Our analysis revealed a different hop expiry behavior, which leads to the dropping of valid, not-expired SCION packets.
This behavior arguably does not fully comply with the SCION specification and can cause unintended issues in SCION applications that cache and use path information for the full validity period.


Anapaya devices run a recent operating system version with some hardening features enabled.
Nevertheless, additional hardening options can be configured to further enhance the security of the devices.
This includes a hardened SSH configuration, option to limit Docker container resources, patched known vulnerabilities, and improved Ubuntu security compliance.
Many compliance mismatches have already been criticized by Maurer's related work (see \cref{sec:operational-device-security} or his work \cite{Maurer2021}).
Since Maurer's analysis was based on Ubuntu 18.04, his findings could have been used to improve the security standpoint of the current devices running Ubuntu 22.04.
In general, most findings have little impact on SCION or require at least some level of access to the device.
However, the possible Rapid Reset attack on the web server and the lack of authentication on the management system pose significant risks, as they can be exploited without device access.
Fortunately, many issues have been addressed and fixed by Anapaya's latest software releases.
Nonetheless, the absence of default authentication on the management system remains a concern, as it can lead to a severe security compromises.
Specifically, in newer management system versions, it is possible to remove existing SSH keys (thereby locking out legit users) or even to add new SSH keys for the root user.
This lack of authentication can lead to a full device compromise.
To recover from such an attack the device has to be reset and reconfigured entirely, which can lead to a significant downtime.

As demonstrated by our volumetric experiments showed, protecting the SCION network from volumetric denial-of-service attacks is crucial to maintaining its availability.
Physical separation of SCION and traditional Internet connections ensures that non-SCION adversaries cannot disrupt SCION performance through volumetric attacks.

However, the network remains vulnerable to attacks originating from within SCION
Our experiments showed that a malicious SCION adversary can still degrade network performance by sending a large volume of SCION packets.
This type of attack can be further intensified by using spoofed source addresses and fake path headers, making the true origin of the attack difficult to trace.

One potential mitigation strategy is the adoption of COLIBRI \cite[Section 10.2]{Perrig2022}, an extension of SCION that enables bandwidth reservation for SCION paths.
However, this approach again relies on the DRKey system to authenticate the source.
An alternative solution that can be used already today is to use hidden paths.
These paths are not publicly advertised and are shared only with trusted parties, such as the CYD Campus network in our case.
Without knowledge of these hidden paths, an attacker would be unable to send SCION packets through them.
It is essential to ensure that the hidden and announced path are physically separated as they share the same underling physical infrastructure.

\section{Limitations}
The analysis of the Anapaya devices was limited to those deployed at CYD Campus.
Other Anapaya customers might have different configurations and security measures in place.
They may also update their devices more frequently and promptly to the latest software versions.
Furthermore, our analysis only covered Anapaya EDGE devices and no CORE or GATE devices.

Due to the time limitations of this thesis, we could not fully analyze the proprietary components of the Anapaya SCION implementation.
Initial reverse engineer efforts did not reveal any critical vulnerabilities.
However, a more comprehensive analysis is necessary to fully understand the security implications of these proprietary changes.

Nevertheless, since all Anapaya customers run the same software, particularly the same SCION implementation, our SCION protocol analysis remains relevant for all Anapaya customers.


\section{Recommendations}

As already emphasized multiple times in the previous chapter and also during discussions with Anapaya, we strongly recommend activating the DRKey feature in their SCION implementation.
Enabling even an experimental version of DRKey would mitigate many attacks and also pave the way for the development of new SCION application that want to employ DRKey.
We further recommend implementing regular key updates to ensure good security hygiene.
Such regular key updates can mitigate the impact of a leaked or compromised key.
Additionally, SCION implementations (both open-source and Anapaya's) should incorporate some sort of outbound filtering to reduce the risk of successful spoofing attacks.

Regarding Anapaya Edge devices, we recommend adhering to best security practices, such as the CIS benchmarks.
These benchmarks cover various security aspects, such as hardware security, kernel hardening, privilege settings, firewall rules, and more.
Regular security assessments and automated vulnerability scans should be conducted to ensure device security.
It is crucial to address the findings of these assessments by deploying corresponding security updates promptly.
A timely update process is essential to mitigate the risk of successful attacks.

Finally, for a secure SCION deployment, it is essential to ensure that the SCION and traditional Internet connection are physically separated.
This separation minimizes the risk of certain attacks, such as volumetric denial-of-service, from affecting the SCION network and its users.
Additionally, hidden paths should be used to protect the network from volumetric attacks originating from within the SCION network.
These paths should be exclusively shared with trusted parties to prevent unauthorized access and exploitation.
Physical separation of hidden and public SCION paths is a critical measure for maintaining the overall security and resilience of the SCION deployment.

